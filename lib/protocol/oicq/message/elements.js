export const ExtendArray=[`long_msg`,`face`,`sface`,`bface`,`dice`,`rps`,`flash`,`location`,`music`,`share`,`json`,`xml`,`poke`,`mirai`];export const segment={long_msg(e){return{type:`long_msg`,resid:e}},text(e,t){return{type:`text`,text:String(e),markdown:t}},face(e,t=!0){return{type:`face`,id:e,big:t}},sface(e,t){return{type:`sface`,id:e,text:t}},bface(e,t){return{type:`bface`,file:e,text:t}},rps(e){return{type:`rps`,id:e}},dice(e){return{type:`dice`,id:e}},at(e,t,n){return{type:`at`,qq:e,text:t,dummy:n}},image(e,t,n,r){return{type:`image`,file:e,cache:t,timeout:n,headers:r}},flash(e,t,n,r){return{type:`flash`,file:e,cache:t,timeout:n,headers:r}},record(e,t={}){return{type:`record`,file:e,...t}},video(e,t={}){return{type:`video`,file:e,...t}},json(e){return{type:`json`,data:e}},xml(e,t){return{type:`xml`,data:e,id:t}},markdown(e,t){return{type:`markdown`,content:e,config:t}},button(e){return Array.isArray(e)?{type:`button`,data:e}:{type:`button`,content:e}},mirai(e){return{type:`mirai`,data:e}},music(e,t=`qq`){return{type:`music`,id:e,platform:t}},fake(e,t,n,r){return{type:`node`,data:{user_id:e,nickname:n,message:t,time:r}}},share(e,t,n,r){return{type:`share`,url:e,title:t,image:n,content:r}},location(e,t,n,r){return{type:`location`,lat:e,lng:t,address:n,id:r}},poke(e){return{type:`poke`,id:e}},fromCqcode(e){let t=[],r=e.matchAll(/\[CQ:[^\]]+\]/g),a=0;for(let o of r){let r=e.slice(a,o.index).replace(/&#91;|&#93;|&amp;/g,unescapeCQ);r&&t.push({type:`text`,text:r});let s=o[0],c=s.replace(`[CQ:`,`type=`);c=c.substr(0,c.length-1),t.push(qs(c)),a=o.index+s.length}if(a<e.length){let r=e.slice(a).replace(/&#91;|&#93;|&amp;/g,unescapeCQ);r&&t.push({type:`text`,text:r})}return t},file(e,t,n){return{type:`file`,file:e,name:t,pid:n}},reply(e,t){return{type:`reply`,id:e,text:t}}};function unescapeCQ(e){return e===`&#91;`?`[`:e===`&#93;`?`]`:e===`&amp;`?`&`:``}function unescapeCQInside(e){return e===`&#44;`?`,`:e===`&#91;`?`[`:e===`&#93;`?`]`:e===`&amp;`?`&`:``}function qs(e,t=`,`,n=`=`){let i={},a=e.split(t);for(let e of a){let t=e.indexOf(n);if(t===-1)continue;i[e.substring(0,t)]=e.substr(t+1).replace(/&#44;|&#91;|&#93;|&amp;/g,unescapeCQInside)}for(let e in i)try{e!==`text`&&(i[e]=JSON.parse(i[e]))}catch{}return i}