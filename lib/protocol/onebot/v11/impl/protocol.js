import{Event}from"../convert/index.js";export default class Protocol{client;convert;constructor(t){this.client=t,this.convert=new Event.OBv11toPhilia(this.client)}handle(e){if(`echo`in e)return this.echo(e);if(`post_type`in e)return this.post(e);this.client.logger.warn(`未知消息`,e)}echo(e){let t=this.client.cache.get(e.echo);t&&(e.retcode===0||e.retcode===1?t.resolve(e.data):t.reject(e))}async post(e){return this.client.event_handle.handle(await this.convert.convert(e))}}